option compress = yes validvarname = any;

libname orig "F:\A_offline_zky\offline_model\01_Dataset\01_original";


data aa;
set orig.sample_data;
format  LOAN_MAX_CREDIT_LINE_AMT_G $20.;
if LOAN_MAX_CREDIT_LINE_AMT<=10000 then LOAN_MAX_CREDIT_LINE_AMT_G="1.(-,10000]";
else if  10000<LOAN_MAX_CREDIT_LINE_AMT<=30000 then LOAN_MAX_CREDIT_LINE_AMT_G="2.(10000,20000]";
else if  30000<LOAN_MAX_CREDIT_LINE_AMT<=50000 then LOAN_MAX_CREDIT_LINE_AMT_G="3.(20000,50000]";
/*else if  30000<LOAN_MAX_CREDIT_LINE_AMT<=50000 then LOAN_MAX_CREDIT_LINE_AMT_G="4.(30000,50000]";*/
else if  50000<LOAN_MAX_CREDIT_LINE_AMT<=200000 then LOAN_MAX_CREDIT_LINE_AMT_G="5.(50000,200000]";
else if  200000<LOAN_MAX_CREDIT_LINE_AMT<=300000 then LOAN_MAX_CREDIT_LINE_AMT_G="7.(200000,300000]";
else if  LOAN_MAX_CREDIT_LINE_AMT>300000 then LOAN_MAX_CREDIT_LINE_AMT_G="8.(300000,+]";
if target^=2;
keep target LOAN_MAX_CREDIT_LINE_AMT LOAN_MAX_CREDIT_LINE_AMT_G;
run;

proc freq data=aa;table target*LOAN_MAX_CREDIT_LINE_AMT_G;run;


data aa1;
set orig.sample_data;
format  CARD_MAX_CREDIT_LINE_AMT_G $20.;
if CARD_MAX_CREDIT_LINE_AMT<=7000 then CARD_MAX_CREDIT_LINE_AMT_G="1.(-,7000]";
else if  7000<CARD_MAX_CREDIT_LINE_AMT<=20000 then CARD_MAX_CREDIT_LINE_AMT_G="2.(7000,20000]";
else if  20000<CARD_MAX_CREDIT_LINE_AMT<=40000 then CARD_MAX_CREDIT_LINE_AMT_G="3.(20000,40000]";
else if  40000<CARD_MAX_CREDIT_LINE_AMT<=60000 then CARD_MAX_CREDIT_LINE_AMT_G="4.(40000,60000]";
else if  60000<CARD_MAX_CREDIT_LINE_AMT<=80000 then CARD_MAX_CREDIT_LINE_AMT_G="5.(60000,80000]";

else if  80000<CARD_MAX_CREDIT_LINE_AMT<=100000 then CARD_MAX_CREDIT_LINE_AMT_G="7.(80000,100000]";

else if  CARD_MAX_CREDIT_LINE_AMT>100000 then CARD_MAX_CREDIT_LINE_AMT_G="8.(100000,+]";
if target^=2;
keep target CARD_MAX_CREDIT_LINE_AMT CARD_MAX_CREDIT_LINE_AMT_G;
run;

proc freq data=aa1;table target*CARD_MAX_CREDIT_LINE_AMT_G;run;


data aa2;
set orig.sample_data;
format  CARD_FIRST_OPEN_MONTH_G $20.;
if CARD_FIRST_OPEN_MONTH<=12 then CARD_FIRST_OPEN_MONTH_G="1.(-,12]";
else if  12<CARD_FIRST_OPEN_MONTH<=24 then CARD_FIRST_OPEN_MONTH_G="2.(12,24]";
else if  24<CARD_FIRST_OPEN_MONTH<=36 then CARD_FIRST_OPEN_MONTH_G="3.(24,36]";
else if  36<CARD_FIRST_OPEN_MONTH<=48 then CARD_FIRST_OPEN_MONTH_G="4.(36,48]";
else if  48<CARD_FIRST_OPEN_MONTH<=60 then CARD_FIRST_OPEN_MONTH_G="5.(48,60]";

else if  60<CARD_FIRST_OPEN_MONTH<=72 then CARD_FIRST_OPEN_MONTH_G="6.(60,72]";
else if  72<CARD_FIRST_OPEN_MONTH<=96 then CARD_FIRST_OPEN_MONTH_G="7.(72,96]";
else if  96<CARD_FIRST_OPEN_MONTH<=120 then CARD_FIRST_OPEN_MONTH_G="8.(96,120]";
else if  120<CARD_FIRST_OPEN_MONTH<=144 then CARD_FIRST_OPEN_MONTH_G="9.(120,144]";
else if  144<CARD_FIRST_OPEN_MONTH<=168 then CARD_FIRST_OPEN_MONTH_G="99.(144,168]";
else if  CARD_FIRST_OPEN_MONTH>168 then CARD_FIRST_OPEN_MONTH_G="999.(168,+]";
if target^=2;
keep target CARD_FIRST_OPEN_MONTH CARD_FIRST_OPEN_MONTH_G;
run;

proc freq data=aa2;table target*CARD_FIRST_OPEN_MONTH_G;run;



data aa3;
set orig.sample_data;
format  CARD_OVER_100PCT_G $20.;
if CARD_OVER_100PCT<=0 then CARD_OVER_100PCT_G="1.(-,0]";
else if  0<CARD_OVER_100PCT<=70 then CARD_OVER_100PCT_G="2.(0,70]";
else if  70<CARD_OVER_100PCT<=85 then CARD_OVER_100PCT_G="3.(50,65]";
/*else if  65<CARD_OVER_100PCT<=80 then CARD_OVER_100PCT_G="5.(65,80]";*/
/*else if  80<CARD_OVER_100PCT<=90 then CARD_OVER_100PCT_G="5.(80,90]";*/

else if  CARD_OVER_100PCT>90 then CARD_OVER_100PCT_G="6.(90,+]";
if target^=2;
keep target CARD_OVER_100PCT CARD_OVER_100PCT_G;
run;

proc freq data=aa3;table target*CARD_OVER_100PCT_G;run;
